<ContentPage
    x:Class="ChessMultitool.ChessGame"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Chess">

    <Grid Padding="0" RowSpacing="18"
          RowDefinitions="110,Auto,Auto">

        <!-- Row 0 : spacer -->
        <Grid Grid.Row="0" />

        <!-- Row 1 : board -->
        <Grid Grid.Row="1" VerticalOptions="Start" HorizontalOptions="Center">
            <Grid x:Name="BoardGrid"
                  WidthRequest="320"
                  HeightRequest="320">
                <Image Source="{DynamicResource BoardImageSource}" Aspect="AspectFill" InputTransparent="True" ZIndex="0" />
                <Grid x:Name="HighlightGrid" RowSpacing="0" ColumnSpacing="0" BackgroundColor="Transparent" ZIndex="1" />
                <Grid x:Name="PieceGrid" RowSpacing="0" ColumnSpacing="0" BackgroundColor="Transparent" ZIndex="2" />
                <ContentView x:Name="MenuContainer" BackgroundColor="Transparent" ZIndex="3" />
            </Grid>
        </Grid>

        <!-- Row 2 : move navigation -->
        <Grid Grid.Row="2"
              ColumnDefinitions="Auto,*,Auto"
              Padding="12,4,12,0"
              VerticalOptions="Start">

            <Button x:Name="PrevBtn"
                    Text="&lt;"
                    WidthRequest="48"
                    Clicked="OnPrevMoveClicked"
                    HorizontalOptions="Center"
                    VerticalOptions="Center" />

            <CollectionView x:Name="MovesView"
                            Grid.Column="1"
                            HeightRequest="60"
                            SelectionMode="Single"
                            SelectionChanged="OnMoveSelected"
                            HorizontalScrollBarVisibility="Never">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" ItemSpacing="8" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Padding="8,6"
                               HasShadow="False"
                               CornerRadius="8"
                               BackgroundColor="{DynamicResource GlobalControlBackgroundColor}"
                               BorderColor="#666"
                               WidthRequest="96">
                            <Label Text="{Binding Text}"
                                   FontSize="15"
                                   HorizontalTextAlignment="Center"
                                   VerticalTextAlignment="Center"
                                   TextColor="{DynamicResource GlobalTextColor}" />
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <Button x:Name="NextBtn"
                    Grid.Column="2"
                    Text="&gt;"
                    WidthRequest="48"
                    Clicked="OnNextMoveClicked"
                    HorizontalOptions="Center"
                    VerticalOptions="Center" />
        </Grid>
    </Grid>
</ContentPage>