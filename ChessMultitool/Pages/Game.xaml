<ContentPage
    x:Class="ChessMultitool.ChessGame"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Chess">

    <Grid Padding="0" RowSpacing="18"
          RowDefinitions="110,Auto,Auto">

        <!-- Row 0 : spacer -->
        <Grid Grid.Row="0" />

        <!-- Row 1 : board -->
        <Grid Grid.Row="1" VerticalOptions="Start" HorizontalOptions="Center">
            <Grid x:Name="BoardGrid"
                  WidthRequest="320"
                  HeightRequest="320">
                <Image Source="{DynamicResource BoardImageSource}" Aspect="AspectFill" InputTransparent="True" ZIndex="0" />
                <Grid x:Name="HighlightGrid" RowSpacing="0" ColumnSpacing="0" BackgroundColor="Transparent" ZIndex="1" />
                <Grid x:Name="PieceGrid" RowSpacing="0" ColumnSpacing="0" BackgroundColor="Transparent" ZIndex="2" />
                <ContentView x:Name="MenuContainer" BackgroundColor="Transparent" ZIndex="3" />
            </Grid>
        </Grid>

        <!-- Row 2 : move navigation -->
        <Grid Grid.Row="2"
              ColumnDefinitions="Auto,*,Auto"
              Padding="20,4,20,0"
              ColumnSpacing="12"
              VerticalOptions="Start">

            <Button x:Name="PrevBtn"
                    Text="&lt;"
                    WidthRequest="48"
                    Clicked="OnPrevMoveClicked"
                    HorizontalOptions="Center"
                    VerticalOptions="Center" />

            <CollectionView x:Name="MovesView"
                            Grid.Column="1"
                            HeightRequest="48"
                            Margin="8,0"
                            SelectionMode="Single"
                            SelectionChanged="OnMoveSelected"
                            HorizontalScrollBarVisibility="Never">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" ItemSpacing="12" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="0,6" Margin="4,0">
                            <Label x:Name="MoveLabel"
                                   Text="{Binding Text}"
                                   FontSize="15"
                                   HorizontalTextAlignment="Center"
                                   VerticalTextAlignment="Center"
                                   TextColor="{DynamicResource GlobalTextColor}" />
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState Name="Normal" />
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="Transparent" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <Button x:Name="NextBtn"
                    Grid.Column="2"
                    Text="&gt;"
                    WidthRequest="48"
                    Clicked="OnNextMoveClicked"
                    HorizontalOptions="Center"
                    VerticalOptions="Center" />
        </Grid>
    </Grid>
</ContentPage>